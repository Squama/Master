<link rel="stylesheet" href="${basePath}/resources/common/libs/fileinput/css/fileinput.min.css">
<style>

#projectaddstep2 .krajee-default.file-preview-frame .kv-file-content {
    height: auto;
}

#projectaddstep2 .krajee-default .file-footer-caption {
    width: 100px;
}

</style>
<script src="${basePath}/resources/common/libs/fileinput/js/fileinput.js"></script>
<script src="${basePath}/resources/common/libs/fileinput/js/locales/zh.js"></script>
<!--BaseFile组件-->
<script src="${basePath}/resources/common/js/base-file.js"></script>
<div class="modal-body" style="max-height:700px;overflow-y:auto;">

    <form id="contract-form" name="contract-form" class="form-horizontal">
     <input type="hidden" name="id" id= "id">
        <div class="box-body">
            <div class="col-md-6">
                
				<div class="form-group">
                    <label  for="workerid" class="col-sm-3 control-label">姓名</label>
					<div class=" col-sm-8">
						<select id="workerid" class="form-control select2 "  name="workerid" style="width:100%" disabled="disabled">
                   			<option selected="selected" value="">选择一个人员</option>
                   		</select>
					</div>
                </div>
                <div class="form-group">
                     <label for="whcd" class="col-sm-3 control-label">文化程度</label>
                     <div class="col-sm-8">
                         <input type="text" class="form-control" id="whcd" name="whcd" placeholder="文化程度" disabled="disabled">
                     </div>
                 </div>
                <div class="form-group">
                    <label for="birthday" class="col-sm-3 control-label">出生日期</label>
                    <div class="input-group date col-sm-8">
                        <div class="input-group-addon">
                            <i class="fa fa-calendar"></i>
                        </div>
                        <input type="text" class="form-control" data-flag="datepicker"
                               data-format="yyyy-mm-dd"
                               id="birthday" name="birthday"
                               placeholder="出生日期" autocomplete="off" disabled="disabled">
                    </div>
                </div>
                <div class="form-group">
                    <label for="address" class="col-sm-3 control-label">家庭住址</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="address" name="address" placeholder="家庭住址" disabled="disabled">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
            	<div class="form-group">
                    <label  for="sex" class="col-sm-3 control-label">性别</label>
					<div class=" col-sm-8">
						<select id="sex" class="form-control"  name="sex" style="width:100%"  disabled="disabled">
                   			<option selected="selected" value="1">男</option>
                   			<option  value="0">女</option>
                   		</select>
					</div>
                </div>
            	<div class="form-group">
                    <label for="workType" class="col-sm-3 control-label">工种</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="workType" name="workType" placeholder="工种" disabled="disabled">
                    </div>
                </div>
                <div class="form-group">
                   <label for="jctime" class="col-sm-3 control-label">进场时间</label>
                   <div class="input-group date col-sm-8">
                       <div class="input-group-addon">
                           <i class="fa fa-calendar"></i>
                       </div>
                       <input type="text" class="form-control" data-flag="datepicker"
                              data-format="yyyy-mm-dd"
                              id="jctime" name="jctime"
                              placeholder="进场时间" autocomplete="off" disabled="disabled">
                   </div>
               </div>
            </div>
            </div>
              <!-- <div class="form-group">
                    <label for="bzjy" class="col-sm-2 control-label">班组教育内容</label>

                    <div class="col-sm-9">
                        <textarea class="form-control" id="bzjy" name="bzjy" placeholder="班组教育内容" rows="5" disabled="disabled"></textarea>
                    </div>
            </div> 
          <div class="form-group">
                    <label for="bzjy" class="col-sm-2 control-label">项目教育内容</label>

                    <div class="col-sm-9">
                        <textarea class="form-control" id="xmjy" name="xmjy" placeholder="项目教育内容" rows="5" disabled="disabled"></textarea>
                    </div>
            </div>-->
             <div class="form-group">
                    <label for="gsjy" class="col-sm-2 control-label">公司教育内容</label>

                    <div class="col-sm-9">
                        <textarea class="form-control" id="gsjy" name="gsjy" placeholder="公司教育内容" rows="5" disabled="disabled"></textarea>
                    </div>
            </div> 
        <!-- /.box-body -->
        <!-- /.box-footer -->
    </form>
    <div class="" style="text-align: center;height:50px;width:100%;">
         <!--以下两种方式提交验证,根据所需选择-->
         <button type="button" class="btn btn-primary" data-btn-type="save" id="jywc">教育完成</button>
     </div>
</div>
<div class="row">
        <div class="col-xs-12">
            <div class="box">
                <!-- /.box-header -->
                <div class="dataTables_filter" id="searchDiv2" style="display: none">
                    <!--查询条件-->
                    <!--查询条件-->
                    <select id="flid" class="form-control select2" name="fjtype" style="width:200px;" operator="eq">
        				<option selected="selected" value="">选择文件分类</option>
       				 </select>
       				 <input id="ryid" name="jyid" style="display: none"/>
       				 <input  name="ly" value="40" style="display: none"/>
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary" data-btn-type="search">查询</button>
                    </div>
                    <div class="btn-group">
                    	<button type="button" class="btn btn-default" data-btn-type="add">新增</button>
                    	<button type="button" class="btn btn-default" data-btn-type="delete">删除</button>
                    </div>
                </div>
                <div class="box-body box-body-mobile">
                    <table id="lwContract_table" class="table table-bordered table-striped table-hover">
                    </table>
                </div>
            </div>
           </div>
         </div>
<script>
var form =null;

var rys = '${rys?default(0)}',ry=0;
if(rys != 0){
	ry = JSON.parse(rys);
}
var fls = '${fls?default(0)}',fl=0;
if(fls != 0){
	fl = JSON.parse(fls);
}
var id = '${id?default(0)}';
$("#ryid").val(id);

var dutycheckTable
$(function() {
	dutycheckTable = new CommonTable("lwContract_table", "aqjyfjList", "searchDiv2");
    //初始化控件
    form=$("#contract-form").form();
    //绑定按钮事件
    $("button[data-btn-type]").click(function () {
        var action = $(this).data("btn-type");
        var rowId = dutycheckTable.getSelectedRowId();
        switch (action) {
       		case "add":
       			modals.openWin({
                    winId:"purchaseApplyWin",
                    title:'创建',
                    width:'1000px',
                    url:basePath+"/sjjynr/addwjfj?ly=40&jyid="+id,
                    hideFunc:function(){
                    	dutycheckTable.reloadData();
                    },
                    
                   }); 
            break;
       		case 'goreturn':
       			loadPage(basePath+"/sjjynr/alllist");
           	break;
       		case 'delete':
       			if(!rowId){
                    modals.info('请选择要删除的行');
                    return false;
                }
                modals.confirm("是否要删除该行数据？",function(){
                    ajaxPost(basePath+"/sjjynr/delete?id="+rowId,null,function(data){
                    	if(data.success){
                    		dutycheckTable.reloadData();
                    	}
                    	
              
                    });
                })
           	break;
        }
    });
    if(fl != 0){
        for (var i = 0, len = fl.length; i < len; i++) {
            var u = fl[i];
            $('#flid').append("<option value='" + u.id + "'>" + u.name + "</option>");
        }
        $("#flid").select2();
    }
    if(ry != 0){
        for (var i = 0, len = ry.length; i < len; i++) {
            var u = ry[i];
            $('#workerid').append("<option value='" + u.id + "'>" + u.name + "</option>");
        }
        $("#workerid").select2();
    }
    form.initComponent();
    load();
    $("#jywc").on("click",function(){
    	modals.confirm("确定教育完成？点击确定将转到下一级教育",function(){
    		ajaxPost(basePath+'/sjjynr/doauidt', {id:id,status:'${status}'}, function(data) {
				if(data.success){
					modals.info("操作成功");
					modals.hideWin(winId);
    			}
            }); 
    	})
    })
});
function load(){
	if(id!=0){//查看
		ajaxPost(basePath+'/sjjynr/loadJy', {id:id}, function(data) {
			$("#contract-form").form().initFormData(data);          
        }); 
	}else{//初始化
		ajaxPost(basePath+'/sjjynr/load', {}, function(data) {
			$("#bzjy").val(data.bzname);
			$("#xmjy").val(data.xmname);
			$("#gsjy").val(data.gsname);
        }); 
	}
}
function setvalue(){
	var workid = $("#workerid option:selected").val();
	if(workid){
		ajaxPost(basePath+'/sjjynr/getWorker', {workid:workid}, function(data) {
			$("#whcd").val(data.whcd);
			$("#birthday").val(jsonYearMonthDay(data.birthday));
			$("#sex").val(data.sex);
			$("#workType").val(data.workType);
			$("#jctime").val(jsonYearMonthDay(data.jctime)); 
			$("#address").val(data.address);
        }); 
	}else{
		 modals.correct("请选择人员");
	}
 }
function resetForm(){
    form.clearForm();
    $("#contract-form").data('bootstrapValidator').resetForm();
}
function jsonYearMonthDay(milliseconds) {
	if (milliseconds == "" || milliseconds == undefined
			|| milliseconds == null) {
		return "";
	} else {
		var datetime = new Date();
		datetime.setTime(milliseconds);
		var year = datetime.getFullYear();
		var month = datetime.getMonth() + 1 < 10 ? "0"
				+ (datetime.getMonth() + 1) : datetime.getMonth() + 1;
		var date = datetime.getDate() < 10 ? "0" + datetime.getDate()
				: datetime.getDate();
		return year + "年" + month + "月" + date+"日";
	}
}

function fnRenderGl(value, type, obj){
	return "<a href='javascript:void(0)' onclick='lookfj(\"" + value + "\")'>文件查看</a>";
}
function lookfj(value){
	modals.openWin({
        winId: "files",
        width: "900px",
        url: basePath + "/sjjynr/projectdetailfile?id=" + value ,
        title: "文件查看"
    });
 }
</script>
