<link rel="stylesheet" href="${basePath}/resources/common/libs/fileinput/css/fileinput.min.css">
<script src="${basePath}/resources/common/libs/fileinput/js/fileinput.js"></script>
<script src="${basePath}/resources/common/libs/fileinput/js/locales/zh.js"></script>
<!--BaseFile组件-->
<script src="${basePath}/resources/common/js/base-file.js"></script>


<section class="content-header">
	<h1>
		新增（入职）员工
	</h1>
	<ol class="breadcrumb">
		<li><a href="${basePath}"><i class="fa fa-dashboard"></i> 首页</a></li>
		<li><a href="#">办公管理</a></li>
		<li class="active">新增用户</li>
	</ol>
</section>
<section class="content">
	<div class="row">
		<div class="col-xs-12">
			<div class="box">
				<form id="user-form" name="user-form" class="form-horizontal">
					<div class="box-body">
						<div class="col-md-6">
							<div class="form-group">
								<label for="name" class="col-sm-3 control-label">姓名</label>
								<div class="col-sm-8">
									<input type="text" class="form-control" id="name" name="name" placeholder="姓名">
								</div>
							</div>
							<div class="form-group">
								<label for="birthday" class="col-sm-3 control-label">出生日期</label>
								<div class="input-group col-sm-8">
									<span class="input-group-addon">
									   <i class="fa fa-calendar"></i>
									</span> 
									<input type="text" class="form-control" data-flag="datepicker" data-format="yyyy-mm-dd" name="birthday" id="birthday" placeholder="出生日期">
								</div>
							</div>
							<div class="form-group">
                                <label for="telphone" class="col-sm-3 control-label">部门</label>

                                <div class="col-sm-6">
                                    <input type="hidden" name="deptId" id="deptId" >
                                    <input type="text" class="form-control" id="deptName" placeholder="所在部门" >
                                </div>
                                <div class="col-sm-2">
                                    <button type="button" class="btn btn-info" data-flag="org"><i
                                            class="fa fa-sitemap"></i>&nbsp;选择
                                    </button>
                                </div>
                            </div>
							<div class="form-group">
								<label for="telphone" class="col-sm-3 control-label">座机</label>

								<div class="col-sm-8">
									<input type="text" class="form-control" id="telphone" name="telphone" placeholder="座机">
								</div>
							</div>
							<div class="form-group">
								<label for="email" class="col-sm-3 control-label">Email</label>

								<div class="col-sm-8">
									<input type="text" class="form-control" id="email" name="email" placeholder="Email">
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group">
								<label class="col-sm-3 control-label">性别</label>

								<div class="col-sm-8">
									<label class="control-label"> 
									   <input type="radio" name="sex" data-flag="icheck" class="square-green" value="1"> 男
									</label> &nbsp; 
									<label class="control-label"> 
									   <input type="radio" name="sex" data-flag="icheck" class="square-green" value="0"> 女
									</label>
								</div>
							</div>
							<div class="form-group">
								<label for="loginName" class="col-sm-3 control-label">登录名</label>

								<div class="col-sm-8">
									<input type="text" class="form-control" id="loginName" name="loginName" placeholder="登录名">
								</div>
							</div>
							<div class="form-group">
                                <label for="telphone" class="col-sm-3 control-label">职务</label>
                                <div class="col-sm-8">
                                    <select type="text" class="form-control" id="job" name="jobId" placeholder="职务" ></select>
                                </div>
                            </div>
							<div class="form-group">
								<label for="mobile" class="col-sm-3 control-label">手机</label>

								<div class="col-sm-8">
									<!--<input type="text" class="form-control" id="mobile" name="mobile" placeholder="手机"
                                                           data-inputmask='"mask": "9999999999999"' data-mask>-->
									<input type="text" class="form-control" id="mobile" name="mobile" placeholder="手机">
								</div>
							</div>
							<div class="form-group">
								<label for="qq" class="col-sm-3 control-label">QQ</label>
								<div class="col-sm-8">
									<input type="text" class="form-control" id="qq" name="qq" placeholder="QQ">
								</div>
							</div>
						</div>
					</div>


					<!-- <input type="hidden" name="fileIds" id="fileIds">
					<div class="form-group" align="center">
						<div class="btn btn-default btn-file" id="uploadFile">
							<i class="fa fa-paperclip"></i> 上传劳务合同(Max. 10MB)
						</div>
					</div>
					<div class="form-group" id="file_container">
						<input type="file" name="file"  id="attachment">
					</div> -->

					<!-- /.box-body -->
					<div class="box-footer text-center">
						<!--以下两种方式提交验证,根据所需选择-->
						<button type="button" class="btn btn-default" data-btn-type="cancel" data-dismiss="modal">取消</button>
						<button type="submit" class="btn btn-primary" data-btn-type="save">提交</button>
					</div>
					<!-- /.box-footer -->
				</form>
			</div>
		</div>
	</div>
</section>



<script>
//tableId,queryId,conditionContainer
var form = null;
var id = "${id?default(0)}";
$(function() {
    //初始化控件
    form = $("#user-form").form({baseEntity:false});
    //数据校验
    $("#user-form").bootstrapValidator({
        message: '请输入有效值',
        feedbackIcons: {
            valid: 'glyphicon glyphicon-ok',
            invalid: 'glyphicon glyphicon-remove',
            validating: 'glyphicon glyphicon-refresh'
        },
        submitHandler: function(validator, userform, submitButton) {
            modals.confirm('确认保存？', function() {
                //Save Data，对应'submit-提交'
                var params = form.getFormSimpleData();
                ajaxPost(
                    basePath + '/employeeQuery/save',
                    params,
                    function(data, status) {
                        if (data.success) {
                        	form.clearForm();
                        	modals.correct("添加用户成功！请等待审核");
                        }
                    });
            });
        },
        fields: {
            name: {
                validators: {
                    notEmpty: {
                        message: '请输入姓名'
                    }
                }
            },
            sex: {
                validators: {
                    notEmpty: {
                        message: '请选择性别'
                    }
                }
            },
            birthday: {
                validators: {
                    notEmpty: {
                        message: '请输入出生日期'
                    },
                    date: {
                        format: $(this).data("format"),
                        message: '请输入有效日期'
                    }
                }
            },
            loginName: {
                validators: {
                    notEmpty: {
                        message: '请输入登录名'
                    }
                }
            },
            jobId: {
                validators: {
                    notEmpty: {
                        message: '请选择职务'
                    }
                }
            },
            email: {
                validators: {
                    notEmpty: {
                        message: '请输入邮件',
                    },
                    emailAddress: {
                        message: '非法的邮件格式',
                    }

                }
            }
        }
    });
    form.initComponent();
    //初始化部门选择器
    $("button[data-flag='org']").org({
        idField: $("#deptId"),
        nameField: $("#deptName"),
        title:'选择部门',
        levels:3

    })
    ajaxPost(basePath+"/employeeQuery/getRylx",null,function(data){
		if(data.data){
			var list = data.data;
			var option = "<option></option>";
			for(var i=0;i<list.length;i++){
				
				option += "<option value='"+list[i].id+"'>"
				+ list[i].name
				+ "</option>";
			}
			$("#job").append(option);
		}
	}) 
});
$("#uploadFile").file({
    title: "请上传附件",
    fileinput: {
        maxFileSize: 10240,
        maxFileCount:3
    },
    fileIdContainer:"[name='fileIds']",
    showContainer:'#attachment',
    //显示文件类型 edit=可编辑  detail=明细 默认为明细
    showType:'edit',
    //弹出窗口 执行上传附件后的回调函数(window:false不调用此方法)
    window:true,
    callback:function(fileIds,oldfileIds){
        //更新fileIds
        this.showFiles({
            fileIds:fileIds
        });
    }
});




function resetForm() {
    form.clearForm();
    $("#user-form").data('bootstrapValidator').resetForm();
}
</script>
